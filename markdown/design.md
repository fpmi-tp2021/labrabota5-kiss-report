\section{Проектирование приложения}

Приложение структурировано по системе **КИС**.


- `src` - исходный код приложения (`.c` файлы)
	- `airway.c` - основное приложение
	- `farbfeld.c` - модуль для работы с картинками farbfeld
	- `farbfeld-print.c` - модуль для вывод картинок farbfeld на экран
- `include` - заголовочные файлы
- `sql` - SQL-скрипты
- `doc` - документация (отчёт)
- `bin` - выходные бинарные файлы

\subsection{Зависимости приложения}

Приложение зависит от библиотек [*SQLite3*](https://sqlite.org/) и [*chafa*](https://hpjansson.org/chafa/).

```shell
$ ldd /usr/local/bin/airway
...
        libsqlite3.so.0 => /usr/lib64/libsqlite3.so.0 (0x00007fc0eaf4e000)
        libchafa.so.0 => /usr/lib64/libchafa.so.0 (0x00007fc0eaf15000)
...
```

Для генерации документа отчёта необходимы *pandoc* и *xelatex*.

\subsection{Farbfeld}
Farbfeld\footnote{\url{https://tools.suckless.org/farbfeld}} - простой формат для изображений, имеющий следующую структуру:

```
╔════════╤═════════════════════════════════════════════════════════╗
║ Bytes  │ Description                                             ║
╠════════╪═════════════════════════════════════════════════════════╣
║ 8      │ farbfeld magic value                                    ║
╟────────┼─────────────────────────────────────────────────────────╢
║ 4      │ 32-Bit BE unsigned integer (width)                      ║
╟────────┼─────────────────────────────────────────────────────────╢
║ 4      │ 32-Bit BE unsigned integer (height)                     ║
╟────────┼─────────────────────────────────────────────────────────╢
║ [2222] │ 4x16-Bit BE unsigned integers [RGBA] / pixel, row-major ║
╚════════╧═════════════════════════════════════════════════════════╝
```

Картинка конвертируется в farbfeld из jpg который хранится в репозитории и занимает значительно меньше места.

```makefile
plane.ff:
	jpg2ff <plane.jpg >$@
```
